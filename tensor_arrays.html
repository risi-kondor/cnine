<!doctype html>
<html class="no-js">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />
<link rel="index" title="Index" href="genindex.html" /><link rel="search" title="Search" href="search.html" /><link rel="next" title="Cell maps and cell operators" href="cell_maps.html" /><link rel="prev" title="Complex tensors" href="ctensor.html" />

    <meta name="generator" content="sphinx-4.2.0, furo 2021.10.09"/>
        <title>Tensor arrays - cnine documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="_static/styles/furo.css?digest=0254c309f5cadf746f1a613e7677379ac9c8cdcd" />
    <link rel="stylesheet" type="text/css" href="_static/styles/furo-extensions.css?digest=16fb25fabf47304eee183a5e9af80b1ba98259b1" />
    
    


<style>
  body {
    --color-code-background: #f8f8f8;
  --color-code-foreground: black;
  
  }
  body[data-theme="dark"] {
    --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
  }
  @media (prefers-color-scheme: dark) {
    body:not([data-theme="light"]) {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
    }
  }
</style></head>
  <body>
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    
<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round">
      <path stroke="none" d="M0 0h24v24H0z" />
      <line x1="4" y1="6" x2="20" y2="6" />
      <line x1="10" y1="12" x2="20" y2="12" />
      <line x1="6" y1="18" x2="20" y2="18" />
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-half" viewBox="0 0 24 24">
    <title>Auto light/dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-shadow">
      <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
      <circle cx="12" cy="12" r="9" />
      <path d="M13 12h5" />
      <path d="M13 15h4" />
      <path d="M13 18h1" />
      <path d="M13 9h4" />
      <path d="M13 6h1" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="index.html"><div class="brand">cnine  documentation</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="index.html">
  
  
  <span class="sidebar-brand-text">cnine  documentation</span>
  
</a><form class="sidebar-search-container" method="get" action="search.html" role="search">
  <input class="sidebar-search" placeholder=Search name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="intro.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="rtensor.html">Real tensors</a></li>
<li class="toctree-l1"><a class="reference internal" href="ctensor.html">Complex tensors</a></li>
<li class="toctree-l1 current current-page"><a class="current reference internal" href="#">Tensor arrays</a></li>
<li class="toctree-l1"><a class="reference internal" href="cell_maps.html">Cell maps and cell operators</a></li>
</ul>

</div>
</div>
      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <div class="content-icon-container">
          <div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main">
          <section id="tensor-arrays">
<h1>Tensor arrays<a class="headerlink" href="#tensor-arrays" title="Permalink to this headline">¶</a></h1>
<p>The basic device in <cite>cnine</cite> for parallelizing computations on the GPU are tensor arrays.
A tensor array is an array of tensors of the same size arranged in a contiguous data structure.
An <code class="docutils literal notranslate"><span class="pre">rtensorArr</span></code> object is an array of real tensors, whereas an <code class="docutils literal notranslate"><span class="pre">ctensorArr</span></code> object is
an array of complex tensors.</p>
<p>We describe the basic functionality of tensor arrays for the <code class="docutils literal notranslate"><span class="pre">rtensorArr</span></code> class.
The API of <code class="docutils literal notranslate"><span class="pre">ctensorArr</span></code> is analogous apart from the addition of some functions taking complex conjugates,
etc..</p>
<section id="creating-tensor-arrays">
<h2>Creating tensor arrays<a class="headerlink" href="#creating-tensor-arrays" title="Permalink to this headline">¶</a></h2>
<p>The following example shows how to create a <img alt="2\times 2" class="math" src="_images/math/722e9acdc2f80ea3b4a4befe6fb5ef31a07f24ef.svg"/> array of <img alt="4\times 4" class="math" src="_images/math/e09ffa3ea05a3d4eea933dfc9ff5f288af38bca5.svg"/>
dimensional tensors filled with random numbers.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">A</span><span class="o">=</span><span class="n">cnine</span><span class="o">.</span><span class="n">rtensorArr</span><span class="o">.</span><span class="n">gaussian</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">],[</span><span class="mi">4</span><span class="p">,</span><span class="mi">4</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
<span class="go">Cell (0,0)</span>
<span class="go">[ -1.23974 -0.407472 1.61201 0.399771 ]</span>
<span class="go">[ 1.3828 0.0523187 -0.904146 1.87065 ]</span>
<span class="go">[ -1.66043 -0.688081 0.0757219 1.47339 ]</span>
<span class="go">[ 0.097221 -0.89237 -0.228782 1.16493 ]</span>


<span class="go">Cell (0,1)</span>
<span class="go">[ -1.50279 0.570759 -0.929941 -0.934988 ]</span>
<span class="go">[ -0.764676 0.250854 -0.188164 -1.51315 ]</span>
<span class="go">[ 1.32256 1.93468 1.25244 1.0417 ]</span>
<span class="go">[ -0.696964 0.537104 0.694816 0.541231 ]</span>


<span class="go">Cell (1,0)</span>
<span class="go">[ -1.13769 -1.22027 0.111152 -0.672931 ]</span>
<span class="go">[ -1.39814 -0.477463 0.643125 1.37519 ]</span>
<span class="go">[ -1.2589 0.259477 -1.6247 -0.996947 ]</span>
<span class="go">[ -0.149277 -1.3338 -1.44352 0.65806 ]</span>


<span class="go">Cell (1,1)</span>
<span class="go">[ -1.20183 -0.399454 -0.727057 0.43853 ]</span>
<span class="go">[ -0.42954 -2.20967 -1.22569 0.73464 ]</span>
<span class="go">[ 0.630166 0.137796 0.674001 -0.281158 ]</span>
<span class="go">[ -1.1945 1.06918 -1.2115 -2.1947 ]</span>
</pre></div>
</div>
</section>
<section id="tensor-array-dimensions">
<h2>Tensor array dimensions<a class="headerlink" href="#tensor-array-dimensions" title="Permalink to this headline">¶</a></h2>
<p>The array dimensions and cell dimensions of a tensor array are accessed as follows.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">A</span><span class="o">=</span><span class="n">cnine</span><span class="o">.</span><span class="n">rtensorArr</span><span class="o">.</span><span class="n">gaussian</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">],[</span><span class="mi">4</span><span class="p">,</span><span class="mi">4</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">adims</span><span class="o">=</span><span class="n">A</span><span class="o">.</span><span class="n">get_adims</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">adims</span><span class="p">)</span>
<span class="go">(2,2)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cdims</span><span class="o">=</span><span class="n">A</span><span class="o">.</span><span class="n">get_cdims</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">cdims</span><span class="p">)</span>
<span class="go">(4,4)</span>
</pre></div>
</div>
</section>
<section id="accessing-tensor-cells">
<h2>Accessing tensor cells<a class="headerlink" href="#accessing-tensor-cells" title="Permalink to this headline">¶</a></h2>
<p>Individual tensors in the tensor array, called <cite>cells</cite>, are accessed similarly to how tensor
elements are accessed in regular tensors.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">B</span><span class="o">=</span><span class="n">A</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">B</span><span class="p">)</span>
<span class="go">[ -1.50279 0.570759 -0.929941 -0.934988 ]</span>
<span class="go">[ -0.764676 0.250854 -0.188164 -1.51315 ]</span>
<span class="go">[ 1.32256 1.93468 1.25244 1.0417 ]</span>
<span class="go">[ -0.696964 0.537104 0.694816 0.541231 ]</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">A</span><span class="p">[[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]]</span><span class="o">=</span><span class="n">A</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
<span class="go">Cell (0,0)</span>
<span class="go">[ -1.23974 -0.407472 1.61201 0.399771 ]</span>
<span class="go">[ 1.3828 0.0523187 -0.904146 1.87065 ]</span>
<span class="go">[ -1.66043 -0.688081 0.0757219 1.47339 ]</span>
<span class="go">[ 0.097221 -0.89237 -0.228782 1.16493 ]</span>


<span class="go">Cell (0,1)</span>
<span class="go">[ -1.23974 -0.407472 1.61201 0.399771 ]</span>
<span class="go">[ 1.3828 0.0523187 -0.904146 1.87065 ]</span>
<span class="go">[ -1.66043 -0.688081 0.0757219 1.47339 ]</span>
<span class="go">[ 0.097221 -0.89237 -0.228782 1.16493 ]</span>


<span class="go">Cell (1,0)</span>
<span class="go">[ -1.13769 -1.22027 0.111152 -0.672931 ]</span>
<span class="go">[ -1.39814 -0.477463 0.643125 1.37519 ]</span>
<span class="go">[ -1.2589 0.259477 -1.6247 -0.996947 ]</span>
<span class="go">[ -0.149277 -1.3338 -1.44352 0.65806 ]</span>


<span class="go">Cell (1,1)</span>
<span class="go">[ -1.20183 -0.399454 -0.727057 0.43853 ]</span>
<span class="go">[ -0.42954 -2.20967 -1.22569 0.73464 ]</span>
<span class="go">[ 0.630166 0.137796 0.674001 -0.281158 ]</span>
<span class="go">[ -1.1945 1.06918 -1.2115 -2.1947 ]</span>
</pre></div>
</div>
</section>
<section id="conversion-to-from-pytorch-tensors">
<h2>Conversion to/from PyTorch tensors<a class="headerlink" href="#conversion-to-from-pytorch-tensors" title="Permalink to this headline">¶</a></h2>
<p>A tensors array with <img alt="d" class="math" src="_images/math/8f9402f3338b3e7e4d699cd6fb5d17dd4a66a69e.svg"/> cell dimensions and <img alt="D" class="math" src="_images/math/57704545f7d4f62342839392ceede001ba7940e6.svg"/> array dimensions can be converted to
a <code class="docutils literal notranslate"><span class="pre">torch.tensor</span></code> with <img alt="D+d" class="math" src="_images/math/09bcbe86e8e516c838fdcb25a865ecd32601fd38.svg"/> dimensions.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">A</span><span class="o">=</span><span class="n">cnine</span><span class="o">.</span><span class="n">rtensorArr</span><span class="o">.</span><span class="n">sequential</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">],[</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
<span class="go">Cell (0,0)</span>
<span class="go">[ 0 1 2 ]</span>
<span class="go">[ 3 4 5 ]</span>
<span class="go">[ 6 7 8 ]</span>

<span class="go">Cell (0,1)</span>
<span class="go">[ 9 10 11 ]</span>
<span class="go">[ 12 13 14 ]</span>
<span class="go">[ 15 16 17 ]</span>

<span class="go">Cell (1,0)</span>
<span class="go">[ 18 19 20 ]</span>
<span class="go">[ 21 22 23 ]</span>
<span class="go">[ 24 25 26 ]</span>

<span class="go">Cell (1,1)</span>
<span class="go">[ 27 28 29 ]</span>
<span class="go">[ 30 31 32 ]</span>
<span class="go">[ 33 34 35 ]</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">B</span><span class="o">=</span><span class="n">A</span><span class="o">.</span><span class="n">torch</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">B</span>
<span class="go">tensor([[[[ 0.,  1.,  2.],</span>
<span class="go">          [ 3.,  4.,  5.],</span>
<span class="go">          [ 6.,  7.,  8.]],</span>

<span class="go">         [[ 9., 10., 11.],</span>
<span class="go">          [12., 13., 14.],</span>
<span class="go">          [15., 16., 17.]]],</span>


<span class="go">        [[[18., 19., 20.],</span>
<span class="go">          [21., 22., 23.],</span>
<span class="go">          [24., 25., 26.]],</span>

<span class="go">         [[27., 28., 29.],</span>
<span class="go">          [30., 31., 32.],</span>
<span class="go">          [33., 34., 35.]]]])</span>
</pre></div>
</div>
<p>Conversely, a <code class="docutils literal notranslate"><span class="pre">torch.tensor</span></code> can be converted into a <code class="docutils literal notranslate"><span class="pre">rtensorArr</span></code> but we need to specify how many of its
leading dimensions are to be interpreted as array dimensions.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">A</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">rand</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">A</span>
<span class="go">tensor([[[0.3004, 0.4147, 0.5666],</span>
<span class="go">        [0.7969, 0.2912, 0.8442],</span>
<span class="go">         [0.9161, 0.7182, 0.4490]],</span>

<span class="go">        [[0.5466, 0.3649, 0.1898],</span>
<span class="go">         [0.5851, 0.2558, 0.2237],</span>
<span class="go">         [0.8992, 0.7448, 0.0836]]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">B</span><span class="o">=</span><span class="n">cnine</span><span class="o">.</span><span class="n">rtensorArr</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">A</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">B</span><span class="p">)</span>
<span class="go">Cell (0)</span>
<span class="go">[ 0.30044 0.414732 0.566644 ]</span>
<span class="go">[ 0.796893 0.291165 0.844217 ]</span>
<span class="go">[ 0.916076 0.718188 0.449004 ]</span>

<span class="go">Cell (1)</span>
<span class="go">[ 0.546558 0.36489 0.189827 ]</span>
<span class="go">[ 0.585105 0.255816 0.223677 ]</span>
<span class="go">[ 0.899194 0.744844 0.083603 ]</span>
</pre></div>
</div>
<p>Complex tensor arrays are converted similarly, with the resulting <code class="docutils literal notranslate"><span class="pre">torch.tensor</span></code> acquiring an extra
leading dimension of size two corresponding to the real and imaginary parts.</p>
</section>
<section id="cellwise-operations">
<h2>Cellwise operations<a class="headerlink" href="#cellwise-operations" title="Permalink to this headline">¶</a></h2>
<p>Tensor arrays support the same arithmetic operations as regular tensors.
By default, a given operation is applied to each cell of the array independently.
For example, the result of adding an <img alt="n\times m" class="math" src="_images/math/819aa26e0dcbbeb8fe9b89e07303d4420d158ccf.svg"/> tensor array <code class="docutils literal notranslate"><span class="pre">A</span></code> to another <img alt="n\times m" class="math" src="_images/math/819aa26e0dcbbeb8fe9b89e07303d4420d158ccf.svg"/>
tensor array <code class="docutils literal notranslate"><span class="pre">A</span></code> is an <img alt="n\times m" class="math" src="_images/math/819aa26e0dcbbeb8fe9b89e07303d4420d158ccf.svg"/> array in which the <img alt="(i,j)" class="math" src="_images/math/9a109dd7181dc89387b1cddb5f9cd7468859b440.svg"/> cell is the sum
of the corresponding cells in <code class="docutils literal notranslate"><span class="pre">A</span></code> and <code class="docutils literal notranslate"><span class="pre">B</span></code>.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">A</span><span class="o">=</span><span class="n">cnine</span><span class="o">.</span><span class="n">rtensorArr</span><span class="o">.</span><span class="n">zero</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">],[</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">B</span><span class="o">=</span><span class="n">cnine</span><span class="o">.</span><span class="n">rtensorArr</span><span class="o">.</span><span class="n">ones</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">],[</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">C</span><span class="o">=</span><span class="n">A</span><span class="o">+</span><span class="n">B</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">C</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]))</span>
<span class="go">[ 1 1 1 ]</span>
<span class="go">[ 1 1 1 ]</span>
<span class="go">[ 1 1 1 ]</span>
</pre></div>
</div>
</section>
<section id="broadcast-operations">
<h2>Broadcast operations<a class="headerlink" href="#broadcast-operations" title="Permalink to this headline">¶</a></h2>
<p>Applying a binary operation to a tensor array and a regular tensor corresponds to
first broadcasting the tensor to an array of the same size and then applying the operation cellwise.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">A</span><span class="o">=</span><span class="n">cnine</span><span class="o">.</span><span class="n">rtensorArr</span><span class="o">.</span><span class="n">zero</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">],[</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">B</span><span class="o">=</span><span class="n">cnine</span><span class="o">.</span><span class="n">rtensor</span><span class="o">.</span><span class="n">ones</span><span class="p">([</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">C</span><span class="o">=</span><span class="n">A</span><span class="o">+</span><span class="n">B</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">C</span><span class="p">)</span>
<span class="go">Cell (0,0)</span>
<span class="go">[ 1 1 1 ]</span>
<span class="go">[ 1 1 1 ]</span>
<span class="go">[ 1 1 1 ]</span>


<span class="go">Cell (0,1)</span>
<span class="go">[ 1 1 1 ]</span>
<span class="go">[ 1 1 1 ]</span>
<span class="go">[ 1 1 1 ]</span>


<span class="go">Cell (1,0)</span>
<span class="go">[ 1 1 1 ]</span>
<span class="go">[ 1 1 1 ]</span>
<span class="go">[ 1 1 1 ]</span>


<span class="go">Cell (1,1)</span>
<span class="go">[ 1 1 1 ]</span>
<span class="go">[ 1 1 1 ]</span>
<span class="go">[ 1 1 1 ]</span>
</pre></div>
</div>
</section>
<section id="widening-and-reduction">
<h2>Widening and reduction<a class="headerlink" href="#widening-and-reduction" title="Permalink to this headline">¶</a></h2>
<p>Summing the array along a given array dimension is called <cite>reduction</cite>, whereas copying it multiple times to
create a new array dimension is called <cite>widening</cite>.
On the GPU, both these operations are performed in <cite>cnine</cite> with fast, parallelized algorithms.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">A</span><span class="o">=</span><span class="n">cnine</span><span class="o">.</span><span class="n">rtensorArr</span><span class="o">.</span><span class="n">gaussian</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">],[</span><span class="mi">4</span><span class="p">,</span><span class="mi">4</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">B</span><span class="o">=</span><span class="n">A</span><span class="o">.</span><span class="n">reduce</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">B</span><span class="p">)</span>
<span class="go">Cell (0)</span>
<span class="go">[ -0.610066 -1.75872 0.0605343 0.221048 ]</span>
<span class="go">[ -0.485987 0.911379 -0.117453 -2.9732 ]</span>
<span class="go">[ -2.15961 1.34379 0.878445 0.246828 ]</span>
<span class="go">[ -0.993059 -0.996571 0.578766 -1.27511 ]</span>


<span class="go">Cell (1)</span>
<span class="go">[ 1.6495 -1.15005 2.06733 -1.53783 ]</span>
<span class="go">[ -1.38929 0.878757 0.348551 0.871658 ]</span>
<span class="go">[ -2.09839 -0.0545999 -1.23761 0.399476 ]</span>
<span class="go">[ -1.30456 -0.378178 1.31794 0.917212 ]</span>


<span class="gp">&gt;&gt;&gt; </span><span class="n">C</span><span class="o">=</span><span class="n">B</span><span class="o">.</span><span class="n">widen</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">C</span><span class="p">)</span>
<span class="go">Cell (0,0)</span>
<span class="go">[ -0.610066 -1.75872 0.0605343 0.221048 ]</span>
<span class="go">[ -0.485987 0.911379 -0.117453 -2.9732 ]</span>
<span class="go">[ -2.15961 1.34379 0.878445 0.246828 ]</span>
<span class="go">[ -0.993059 -0.996571 0.578766 -1.27511 ]</span>


<span class="go">Cell (0,1)</span>
<span class="go">[ -0.610066 -1.75872 0.0605343 0.221048 ]</span>
<span class="go">[ -0.485987 0.911379 -0.117453 -2.9732 ]</span>
<span class="go">[ -2.15961 1.34379 0.878445 0.246828 ]</span>
<span class="go">[ -0.993059 -0.996571 0.578766 -1.27511 ]</span>


<span class="go">Cell (0,2)</span>
<span class="go">[ -0.610066 -1.75872 0.0605343 0.221048 ]</span>
<span class="go">[ -0.485987 0.911379 -0.117453 -2.9732 ]</span>
<span class="go">[ -2.15961 1.34379 0.878445 0.246828 ]</span>
<span class="go">[ -0.993059 -0.996571 0.578766 -1.27511 ]</span>


<span class="go">Cell (1,0)</span>
<span class="go">[ 1.6495 -1.15005 2.06733 -1.53783 ]</span>
<span class="go">[ -1.38929 0.878757 0.348551 0.871658 ]</span>
<span class="go">[ -2.09839 -0.0545999 -1.23761 0.399476 ]</span>
<span class="go">[ -1.30456 -0.378178 1.31794 0.917212 ]</span>


<span class="go">Cell (1,1)</span>
<span class="go">[ 1.6495 -1.15005 2.06733 -1.53783 ]</span>
<span class="go">[ -1.38929 0.878757 0.348551 0.871658 ]</span>
<span class="go">[ -2.09839 -0.0545999 -1.23761 0.399476 ]</span>
<span class="go">[ -1.30456 -0.378178 1.31794 0.917212 ]</span>


<span class="go">Cell (1,2)</span>
<span class="go">[ 1.6495 -1.15005 2.06733 -1.53783 ]</span>
<span class="go">[ -1.38929 0.878757 0.348551 0.871658 ]</span>
<span class="go">[ -2.09839 -0.0545999 -1.23761 0.399476 ]</span>
<span class="go">[ -1.30456 -0.378178 1.31794 0.917212 ]</span>
</pre></div>
</div>
</section>
<section id="gpu-functionality">
<h2>GPU functionality<a class="headerlink" href="#gpu-functionality" title="Permalink to this headline">¶</a></h2>
<p>Tensor arrays can moved back and forth between the host (CPU) and the GPU similarly to tensors.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">A</span><span class="o">=</span><span class="n">cnine</span><span class="o">.</span><span class="n">rtensorArr</span><span class="o">.</span><span class="n">sequential</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">],[</span><span class="mi">4</span><span class="p">,</span><span class="mi">4</span><span class="p">],</span><span class="n">device</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> <span class="c1"># create a tensor array on the GPU</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">A</span><span class="o">.</span><span class="n">device</span><span class="p">()</span> <span class="c1"># print out where A is stored</span>
<span class="go">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">B</span><span class="o">=</span><span class="n">A</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="c1"># Create a copy of A on the CPU</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">B</span><span class="o">.</span><span class="n">device</span><span class="p">()</span> <span class="c1"># print out where B is stored</span>
<span class="go">0</span>
</pre></div>
</div>
<dl>
<dt>..note::</dt><dd><p>The default C++ backend class for real tensors arrays is <code class="docutils literal notranslate"><span class="pre">RtensorArrayA</span></code>
and for complex tensor arrays is <code class="docutils literal notranslate"><span class="pre">CtensorArrayA</span></code>.
<code class="docutils literal notranslate"><span class="pre">RtensorArrayA</span></code> stores an <img alt="D_1\times \ldots \times D_K" class="math" src="_images/math/acf705b40686b903a367c1a55a843afba22c2dda.svg"/> array of  <img alt="d_1\times\ldots\times d_k" class="math" src="_images/math/32cd00a5e0ce6e93f9d616d3991f6c71e697b7dc.svg"/>
dimensional tensors in a similar way that <code class="docutils literal notranslate"><span class="pre">RtensorA</span></code> would store a single
<img alt="D_1\times \ldots \times D_K\times d_1\times\ldots\times d_k" class="math" src="_images/math/b17487aa69d14a3b431e07af0bc75bdaa3b39fa7.svg"/> dimensional tensor.
An important caveat, however, is that
the stride between consecutive cells is rounded up to the nearest multiple of 128 bytes.
While this facilitates memory access, especially on the GPU, it makes it somewhat harder to
convert a <code class="docutils literal notranslate"><span class="pre">tensor_array</span></code> object to a single tensor in e.g.. <cite>PyTorch</cite>.
The <code class="docutils literal notranslate"><span class="pre">CtensorArrayA</span></code> class stores a complex tensor array in a single array,
consisting of two real tensor arrays back to back.</p>
<p>A tensor array object’s header, including information about tensor dimensions, strides, etc., is always resident on
the host. When a tensor array is moved to the GPU, only the array containing the actual tensor entries
is moved to the  GPU’s global memory.</p>
</dd>
</dl>
</section>
</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="cell_maps.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">Cell maps and cell operators</div>
              </div>
              <svg><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="ctensor.html">
              <svg><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">Complex tensors</div>
                
              </div>
            </a>
        </div>

        <div class="related-information">
              Copyright &#169; 2021, Risi Kondor |
            Built with <a href="https://www.sphinx-doc.org/">Sphinx</a>
              and
              <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
              <a href="https://github.com/pradyunsg/furo">Furo theme</a>. |
            <a class="muted-link" href="_sources/tensor_arrays.rst.txt"
               rel="nofollow">
              Show Source
            </a>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            Contents
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">Tensor arrays</a><ul>
<li><a class="reference internal" href="#creating-tensor-arrays">Creating tensor arrays</a></li>
<li><a class="reference internal" href="#tensor-array-dimensions">Tensor array dimensions</a></li>
<li><a class="reference internal" href="#accessing-tensor-cells">Accessing tensor cells</a></li>
<li><a class="reference internal" href="#conversion-to-from-pytorch-tensors">Conversion to/from PyTorch tensors</a></li>
<li><a class="reference internal" href="#cellwise-operations">Cellwise operations</a></li>
<li><a class="reference internal" href="#broadcast-operations">Broadcast operations</a></li>
<li><a class="reference internal" href="#widening-and-reduction">Widening and reduction</a></li>
<li><a class="reference internal" href="#gpu-functionality">GPU functionality</a></li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/scripts/main.js"></script>
    </body>
</html>